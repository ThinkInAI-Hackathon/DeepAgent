# 1. è·å–å®ä¾‹
```python
# å¯¼å…¥
>>> from wxautox import WeChat
# è·å–å¾®ä¿¡çª—å£å¯¹è±¡
>>> wx = WeChat()
åˆå§‹åŒ–æˆåŠŸï¼Œè·å–åˆ°å·²ç™»å½•çª—å£ï¼šxxxx
```
# 2. å‘é€æ¶ˆæ¯ç›¸å…³
## 2.1 å‘é€æ–‡å­—æ¶ˆæ¯ï¼ˆæ‰“å­—æœºæ¨¡å¼ï¼‰
wx.SendTypingText
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| msg | str | / | è¦å‘é€çš„æ–‡å­—å†…å®¹ |
| who | str | None| è¦å‘é€ç»™è°ï¼Œé»˜è®¤å‘é€ç»™å½“å‰æ‰“å¼€çš„é¡µé¢ |
| clear | bool | True | æ˜¯å¦æ¸…æ¥šåŸæœ¬èŠå¤©æ¡†çš„å†…å®¹ |
| at | list,str | None | è¦@çš„äººï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªäººï¼Œæ ¼å¼ä¸ºstræˆ–listï¼Œä¾‹å¦‚ï¼š"å¼ ä¸‰"æˆ–["å¼ ä¸‰", "æå››"] |
| exact | bool | False | whoå‚æ•°æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤False |

è¿”å›å€¼ï¼šæ— 

ç¤ºä¾‹ï¼š
```bash
# å‘é€æ¶ˆæ¯
>>> who = 'æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹'
>>> msg = '''è¿™æ˜¯ä¸€æ¡æ¶ˆæ¯
è¿™æ˜¯ç¬¬äºŒè¡Œ
è¿™æ˜¯ç¬¬ä¸‰è¡Œ'''
wx.SendTypingText(msg, who=who)
# æ¢è¡ŒåŠ@åŠŸèƒ½
who = 'å·¥ä½œç¾¤'
msg = '''å„ä½ä¸‹åˆå¥½
{@å¼ ä¸‰}è´Ÿè´£xxx
{@æå››}è´Ÿè´£xxxx'''
wx.SendTypingText(msg, who=who)
```

## 2.2 å‘é€æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘æ¶ˆæ¯
wx.SendFiles
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| filepath | str,list | / | æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå•ä¸ªæ–‡ä»¶strï¼Œå¤šä¸ªæ–‡ä»¶list |
| who | str | None | è¦å‘é€ç»™è°ï¼Œé»˜è®¤åˆ™å‘é€ç»™å½“å‰æ‰“å¼€çš„é¡µé¢ |
| exact | bool | False | whoå‚æ•°æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤Flase |

è¿”å›å€¼ï¼ˆboolï¼‰ï¼šå¦‚æœå‘é€æˆåŠŸåˆ™è¿”å›Trueï¼Œå¦åˆ™ä¸ºFalse

ç¤ºä¾‹ï¼š
```bash
# ç»™â€œæ–‡ä»¶ä¼ è¾“åŠ©æ‰‹â€å‘é€æ–‡ä»¶ï¼ˆå›¾ç‰‡åŒç†ï¼‰
>>> who = 'æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹'
# æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰
>>> files = ['D:/test/test1.txt', 'D:/test/test2.txt', 'D:/test/test3.txt']
>>> wx.SendFiles(files, who=who)
```

# 3. è·å–æ¶ˆæ¯
## 3.1 è·å–å†å²æ¶ˆæ¯
### 3.1.1 è·å–å¾®ä¿¡ä¸»çª—å£å½“å‰èŠå¤©çª—å£UIæ¡†æ¶å·²åŠ è½½æ‰€æœ‰èŠå¤©è®°å½•
wx.GetAllMessage
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| savepic | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©å›¾ç‰‡ |
| savevideo | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©è§†é¢‘ |
| savefile | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©æ–‡ä»¶ |
| savevoice | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜è¯­éŸ³è½¬æ–‡å­—å†…å®¹ |
| parseurl | bool | False | æ˜¯å¦è‡ªåŠ¨è·å–å¡ç‰‡é“¾æ¥ |

è¿”å›å€¼(List[Message])ï¼šè¿”å›ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œåˆ—è¡¨å…ƒç´ ä¸º Message å¯¹è±¡ã€‚

### 3.1.2 åŠ è½½å¾®ä¿¡ä¸»çª—å£å½“å‰èŠå¤©çª—å£UIæ¡†æ¶æ›´å¤šæ¶ˆæ¯
wx.LoadMoreMessage
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| interval | float | 0.3 | æ»šåŠ¨é—´éš”æ—¶é—´ï¼Œçœ‹è‡ªå·±ç”µè„‘å¡é¡¿ç¨‹åº¦è°ƒæ•´ï¼Œé»˜è®¤0.3ç§’ |

è¿”å›å€¼(bool)ï¼šæˆåŠŸåŠ è½½è¿”å›Trueï¼Œå¦åˆ™è¿”å›False

## 3.3 ç›‘å¬æ¨¡å¼è·å–æ¶ˆæ¯ï¼ˆå¾®ä¿¡å­çª—å£æ¨¡å¼ï¼Œæ— éœ€æ¶ˆæ¯å…æ‰“æ‰°ï¼Œæ•ˆç‡æœ€é«˜ï¼‰
ç›‘å¬æ¨¡å¼æŒ‡çš„æ˜¯å°†æŒ‡å®šèŠå¤©çª—å£ç‹¬ç«‹å‡ºå»ï¼Œæ˜¯ä¸ºäº†é¿å…å¾®ä¿¡ä¸»çª—å£å› ä¸ºåˆ‡æ¢èŠå¤©é¡µé¢å¯¼è‡´ç›®æ ‡çª—å£ä¸­èŠå¤©æ¶ˆæ¯çš„UIå…ƒç´ æ¶ˆå¤±ï¼Œä»è€Œå¤±å»åˆ¤æ–­å“ªäº›æ˜¯å†å²æ¶ˆæ¯å“ªäº›æ˜¯æ–°æ¶ˆæ¯çš„ä¾æ®ã€‚è¿™ç§æ–¹å¼å¯¹æ–°æ¶ˆæ¯åˆ¤æ–­çš„å‡†ç¡®ç‡é«˜ã€è·å–æ•ˆç‡ä¹Ÿé«˜ï¼Œç¼ºç‚¹æ˜¯å†…å­˜å ç”¨å¤§ã€ç‹¬ç«‹çª—å£æœ‰æ•°é‡é™åˆ¶
### 3.3.1 æ·»åŠ ç›‘å¬å¯¹è±¡
wx.AddListenChat
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| who | str | / | è¦ç›‘å¬çš„ç¾¤åæˆ–å¥½å‹å |
| savepic | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©å›¾ç‰‡ |
| savevideo | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©è§†é¢‘ |
| savefile | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©æ–‡ä»¶ |
| savevoice | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜è¯­éŸ³è½¬æ–‡å­—å†…å®¹ |
| parseurl | bool | False | æ˜¯å¦è‡ªåŠ¨è·å–å¡ç‰‡é“¾æ¥ |
| exact | bool | False | whoå‚æ•°æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤False |

### 3.3.2 è·å–ç›‘å¬æ¶ˆæ¯
wx.GetListenMessage
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| who | str | None | å·²ç›‘å¬çš„ç¾¤åæˆ–å¥½å‹åï¼Œä¸å¡«åˆ™è·å–æ‰€æœ‰ç›‘å¬å¯¹è±¡çš„æ–°æ¶ˆæ¯ |

è¿”å›å€¼(Dict[ChatWnd, List[Message]])ï¼šè¿”å›ä¸€ä¸ªå­—å…¸ï¼Œkeyä¸ºä¸€ä¸ªå¾®ä¿¡å­çª—å£ ChatWnd å¯¹è±¡ï¼Œè¯¦è§ ChatWnd å¯¹è±¡ç›¸å…³è¯´æ˜ï¼›valueä¸ºæ¶ˆæ¯å†…å®¹ï¼Œlistæ ¼å¼ï¼Œåˆ—è¡¨å…ƒç´ ä¸º Message å¯¹è±¡ã€‚

### 3.3.3 ç§»é™¤ç›‘å¬å¯¹è±¡
wx.RemoveListenChat


è¿”å›å€¼ï¼šæ— 

# 4. è·å–é€šè®¯å½•ç›¸å…³
## 4.1 è·å–é€šè®¯å½•å¥½å‹
### 4.1.1 è·å–ç²—ç•¥ä¿¡æ¯
wx.GetAllFriends
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| keywords | str | None | æœç´¢å¹¶ç­›é€‰å…³é”®è¯ |

ç¤ºä¾‹ï¼š
```bash
>>> wx.GetAllFriends()
[{'nickname': 'å¼ ä¸‰', 'remark': 'å¼ æ€»', 'tags': None},
{'nickname': 'æå››', 'remark': None, 'tags': ['åŒäº‹', 'åˆä¸­åŒå­¦']},
{'nickname': 'ç‹äº”', 'remark': None, 'tags': None},
...]
```

### 4.1.2 è·å–è¯¦ç»†ä¿¡æ¯
wx.GetFriendDetails
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| n | int | None | è·å–å‰nä¸ªå¥½å‹è¯¦æƒ…ä¿¡æ¯, é»˜è®¤ä¸ºNoneï¼Œè·å–æ‰€æœ‰å¥½å‹è¯¦æƒ…ä¿¡æ¯ |
| tag | str | 'A' | ä»å“ªä¸ªæ ‡ç­¾å¼€å§‹è·å–ï¼ŒA-Zå…¶ä¸­ä¸€ä¸ª |
| timeout | int | 0xFFFFF  | è·å–å¥½å‹è¯¦æƒ…ä¿¡æ¯çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ |

ç¤ºä¾‹ï¼š
```bash
>>> wx.GetFriendDetails()
[{'å¾®ä¿¡å·ï¼š': 'abc123456',
'åœ°åŒºï¼š': 'ä¸Šæµ· æµ¦ä¸œæ–°åŒº',
'å¤‡æ³¨': '',
'æ ‡ç­¾': 'wxauto',
'å…±åŒç¾¤èŠ': '1ä¸ª',
'æ¥æº': 'é€šè¿‡æ‰«ä¸€æ‰«æ·»åŠ ',
'æ˜µç§°': 'å¼ ä¸‰'},
{'å¤‡æ³¨': '',
'ä¼ä¸š': 'å¹¿å·èåˆ›æ–‡æ—…åŸ',
'å®å': '**è¹',
'å®˜æ–¹å•†åŸ': 'ğŸ«è´­æ»‘é›ªç¥¨å…¥å£ğŸ«',
'é€šçŸ¥': 'å›å¤æ—¶é—´ä¸ºå·¥ä½œæ—¥9ç‚¹-18ç‚¹',
'ä¼šå‘˜å•†åŸ': 'ğŸ‚çƒ­é›ªå€¼å…‘æ¢é›ªç¥¨ğŸ‚',
'å†°ç®±èµæ»‘': 'ğŸ‘¬ç”³è¯·å†°ç®±ä¸»ç†äººğŸ‘­',
'å…¨æ°‘æ»‘é›ª': 'è´­ç¥¨èµ¢é»„é‡‘ä¼šç±',
'å…±åŒç¾¤èŠ': '1ä¸ª',
'æ˜µç§°': 'å¹¿å·å¤§å†°ç®±'},...]
```

è¿”å›å€¼(List[Dict[str, str]])ï¼šè¿”å›å€¼æ˜¯ä¸€ä¸ªlistï¼Œåˆ—è¡¨å…ƒç´ ä¸ºdictï¼Œæ¯ä¸ªdictåŒ…å«äº†ä¸€ä¸ªå¥½å‹çš„è¯¦ç»†ä¿¡æ¯

# 5. é¡µé¢åˆ‡æ¢
## 5.1 åˆ‡æ¢å¾®ä¿¡ä¸»çª—å£èŠå¤©é¡µé¢
wx.ChatWith
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| who | str | / | è¦æ‰“å¼€çš„èŠå¤©æ¡†å¥½å‹åæˆ–ç¾¤å |
| exact | bool | False | whoå‚æ•°æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤False |

è¿”å›å€¼(str)ï¼šè¿”å›å€¼ä¸ºåˆ‡æ¢åçš„èŠå¤©åï¼Œä¸€èˆ¬ç­‰äºwhoå˜é‡ï¼Œåœ¨ä¸ç²¾ç¡®åŒ¹é…ä¸‹å¯èƒ½ä¸ä¸€æ ·ã€‚
## 5.2 åˆ‡æ¢åˆ°é€šè®¯å½•é¡µé¢
wx.SwitchToContact
## 5.3 åˆ‡æ¢åˆ°èŠå¤©é¡µé¢
wx.SwitchToChat

# 6. å…¶ä»–å¯¹è±¡
## 6.1 æ¶ˆæ¯å¯¹è±¡ Message
æ¶ˆæ¯å¯¹è±¡æŒ‡çš„æ˜¯ GetAllMessage ã€ GetListenMessage ç­‰æ‰€æœ‰æœ‰å…³è·å–æ¶ˆæ¯çš„æ–¹æ³•è¿”å›çš„åˆ—è¡¨å†…çš„å¯¹è±¡å…ƒç´ ï¼Œä¸€å…±æœ‰äº”ç§ Message å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯ç³»ç»Ÿæ¶ˆæ¯ SysMessage ã€æ—¶é—´æ¶ˆæ¯ TimeMessage ã€æ’¤å›æ¶ˆæ¯ RecallMessage ã€è‡ªå·±å‘å‡ºçš„æ¶ˆæ¯ SelfMessage ã€æœ‹å‹å‘æ¥çš„æ¶ˆæ¯ FriendMessage

æ‰€æœ‰æ¶ˆæ¯å¯¹è±¡éƒ½æ”¯æŒä»¥ä¸‹å±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| type | str | æ¶ˆæ¯æ¥æºç±»å‹ |
| mtype | str | æ¶ˆæ¯å†…å®¹ç±»å‹ï¼Œä»…è®¾ç½®äº†ä¿å­˜æŸç§ç±»å‹çš„æ¶ˆæ¯æ‰ä¼šæœ‰ï¼Œå¦åˆ™ä¸ºç©º |
| content | str | æ¶ˆæ¯å†…å®¹ |
| sender | str | å‘é€è€… |
| info | list | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ |
| control | uiautomation.Control  | è¯¥æ¶ˆæ¯çš„uiautomationæ§ä»¶ |
| id | str | æ¶ˆæ¯id |
æ‰€æœ‰æ¶ˆæ¯å¯¹è±¡éƒ½æ”¯æŒä»¥ä¸‹æ–¹æ³•ï¼š
- roll_into_viewï¼šå°†è¯¥æ¶ˆæ¯æ»šåŠ¨è‡³èŠå¤©çª—å£å¯è§ä½ç½®ï¼Œä¾¿äºæ“ä½œ

### 6.1.1 ç³»ç»Ÿæ¶ˆæ¯ SysMessage
æ”¯æŒå±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| type | str | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º sys |
| content | str | æ¶ˆæ¯å†…å®¹ |
| sender | str | å‘é€è€…ï¼Œå›ºå®šä¸º SYS |
| info | list | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ |
| control | uiautomation.Control  | è¯¥æ¶ˆæ¯çš„uiautomationæ§ä»¶ |
| id | str | æ¶ˆæ¯id |

### 6.1.2 æ—¶é—´æ¶ˆæ¯ TimeMessage
æ”¯æŒå±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| type | str | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º time |
| content | str | æ¶ˆæ¯å†…å®¹ |
| sender | str | å‘é€è€…ï¼Œå›ºå®šä¸º Time |
| time | str | æ—¶é—´æ¶ˆæ¯å†…å®¹ï¼Œæ ¼å¼ä¸º %Y-%m-%d %H:%M |
| info | list | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ |
| control | uiautomation.Control  | è¯¥æ¶ˆæ¯çš„uiautomationæ§ä»¶ |
| id | str | æ¶ˆæ¯id |

### 6.1.3 è‡ªå·±å‘å‡ºçš„æ¶ˆæ¯ SelfMessage
æ”¯æŒå±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| type | str | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º self |
| mtype | str | æ¶ˆæ¯å†…å®¹ç±»å‹ï¼Œtextã€imageã€videoã€fileã€voiceã€card |
| content | str | æ¶ˆæ¯å†…å®¹ |
| sender | str | å‘é€è€… |
| info | list | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ |
| control | uiautomation.Control  | è¯¥æ¶ˆæ¯çš„uiautomationæ§ä»¶ |
| id | str | æ¶ˆæ¯id |

### 6.1.5 æœ‹å‹å‘æ¥çš„æ¶ˆæ¯ FriendMessage
æ”¯æŒå±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| type | str | æ¶ˆæ¯ç±»å‹ï¼Œå›ºå®šä¸º friend |
| mtype | str | æ¶ˆæ¯å†…å®¹ç±»å‹ï¼Œtextã€imageã€videoã€fileã€voiceã€card |
| content | str | æ¶ˆæ¯å†…å®¹ |
| sender | str | å‘é€è€… |
| sender_remark | str | å‘é€è€…å¤‡æ³¨å |
| info | list | åŸå§‹æ¶ˆæ¯ä¿¡æ¯ï¼ŒåŒ…å«äº†æ¶ˆæ¯çš„æ‰€æœ‰ä¿¡æ¯ |
| control | uiautomation.Control  | è¯¥æ¶ˆæ¯çš„uiautomationæ§ä»¶ |
| id | str | æ¶ˆæ¯id |

6.2 å¾®ä¿¡å­çª—å£å¯¹è±¡ ChatWnd

å¾®ä¿¡å­çª—å£å¯¹è±¡æŒ‡çš„æ˜¯ä»å¾®ä¿¡ä¸»çª—å£ç‹¬ç«‹å‡ºæ¥çš„èŠå¤©çª—å£ï¼Œä¸»è¦ç”¨äºç›‘å¬æ¨¡å¼ä¸‹å¯¹èŠå¤©çª—å£çš„å„ç§æ“ä½œã€‚

æ”¯æŒå±æ€§ï¼š
| å‚æ•°å | ç±»å‹ | è¯´æ˜ |
| --- | --- | --- |
| who | str | è¯¥å­çª—å£å¯¹åº”çš„å¥½å‹/ç¾¤å |
| UiaAPI | str | è¯¥å­çª—å£çš„uiautomationæ§ä»¶ |
| editbox | str | è¯¥å­çª—å£ä¸­æ¶ˆæ¯ç¼–è¾‘æ¡†çš„uiautomationæ§ä»¶ |
| savepic | bool | ç”¨äºè®¾ç½®ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨ä¸‹è½½å›¾ç‰‡ |
| savevideo | bool | ç”¨äºè®¾ç½®ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨ä¸‹è½½è§†é¢‘ |
| savefile | bool | ç”¨äºè®¾ç½®ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ |
| savevoice | bool | ç”¨äºè®¾ç½®ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨è·å–è¯­éŸ³è½¬æ–‡å­— |
| parseurl | bool | ç”¨äºè®¾ç½®ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨è§£æå¡ç‰‡é“¾æ¥ |

æˆ‘ä»¬å°†å¾®ä¿¡å­çª—å£å¯¹è±¡å‘½åä¸ºchatï¼Œåç»­æ–‡æ¡£å†…ä¸å†é‡å¤å®šä¹‰ï¼š
```python
who = 'å¼ ä¸‰'
savepic = True
savefile = False
savevoice = True
parseurl = False
wx.AddListenChat(
who
savepic=savepic,
savefile=savefile,
savevoice=savevoice,
parseurl=parseurl
) # è¯¥æ–¹æ³•ä¼šå°†â€œå¼ ä¸‰â€çš„èŠå¤©çª—å£åŠ å…¥ç›‘å¬ï¼Œå¹¶æŠŠä»–çš„èŠå¤©çª—å£ç‹¬ç«‹å‡ºæ¥ï¼Œåœ¨wx.listenè¿™ä¸ªdict
ä¸­è®°å½•
wx.listen
# {'å¼ ä¸‰': <wxauto Chat Window at 0xbac39c32 for å¼ ä¸‰>}
chat = wx.listen[who] # åç»­æ–‡æ¡£å†…ä¸å†é‡å¤å®šä¹‰chat
```
### 6.2.1 åŠ è½½è¯¥å­çª—å£å½“å‰UIæ¡†æ¶æ›´å¤šæ¶ˆæ¯
chat.LoadMoreMessage
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| interval | float | 0.3 | æ»šåŠ¨é—´éš”æ—¶é—´ï¼Œçœ‹è‡ªå·±ç”µè„‘å¡é¡¿ç¨‹åº¦è°ƒæ•´ï¼Œé»˜è®¤0.3ç§’ |
### 6.2.2 è·è¯¥å­çª—å£å½“å‰UIæ¡†æ¶å·²åŠ è½½æ‰€æœ‰èŠå¤©è®°å½•
chat.GetAllMessage
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| savepic | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©å›¾ç‰‡ |
| savevideo | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©è§†é¢‘ |
| savefile | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜èŠå¤©æ–‡ä»¶ |
| savevoice | bool | False | æ˜¯å¦è‡ªåŠ¨ä¿å­˜è¯­éŸ³è½¬æ–‡å­—å†…å®¹ |
| parseurl | bool | False | æ˜¯å¦è‡ªåŠ¨è·å–å¡ç‰‡é“¾æ¥ |

8.2.3 å‘é€æ–‡å­—æ¶ˆæ¯ï¼ˆæ‰“å­—æœºæ¨¡å¼ï¼‰
chat.SendTypingText
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| msg | str | / | è¦å‘é€çš„æ–‡å­—å†…å®¹ |
| clear | bool | True | æ˜¯å¦æ¸…æ¥šåŸæœ¬èŠå¤©æ¡†çš„å†…å®¹ |
| at | list,str | None | è¦@çš„äººï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªäººï¼Œæ ¼å¼ä¸ºstræˆ–listï¼Œä¾‹å¦‚ï¼š"å¼ ä¸‰"æˆ–["å¼ ä¸‰", "æå››"] |
| exact | bool | False | whoå‚æ•°æ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤False |
### 6.2.4 å‘é€æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘æ¶ˆæ¯
chat.SendFiles
| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
| --- | --- | --- | --- |
| filepath | str,list | / | æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå•ä¸ªæ–‡ä»¶strï¼Œå¤šä¸ªæ–‡ä»¶list |